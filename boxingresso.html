<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>1Mapa MTS25 – Visualizador (WebP)</title>
  <style>
    *{box-sizing:border-box}
    html,body{height:100%;margin:0}
    body{background:#0b0b0c;color:#e9e9ef;font:14px/1.4 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,Arial;overscroll-behavior:none}
    #stage{position:fixed;inset:0;overflow:hidden;touch-action:none}
    #img{position:absolute;left:0;top:0;display:block;image-rendering:auto;will-change:transform;touch-action:none}
    .hud{position:fixed;right:12px;top:12px;display:flex;flex-direction:column;gap:8px;z-index:10}
    .btn{border:1px solid #2a2a2b;background:#161618;color:#e9e9ef;padding:10px 12px;border-radius:12px;cursor:pointer;box-shadow:0 6px 18px rgba(0,0,0,.35)}
    .btn:active{transform:translateY(1px)}
  </style>
</head>
<body>
  <div id="stage"><img id="img" alt="Mapa" /></div>
  <div class="hud">
    <button class="btn" id="zoomIn">＋</button>
    <button class="btn" id="zoomOut">－</button>
    <button class="btn" id="reset">Reiniciar</button>
  </div>
  <script>
    (function(){
      const IMG_PATH = "MTS25.webp";
      const stage=document.getElementById('stage');
      const img=document.getElementById('img');
      const EDGE_PAD=0.08;
      const TOUCH_BOOST=2.2;
      let s=1, s0=1, sMin=0.2, sMax=12, tx=0, ty=0, vw=0, vh=0, iw=0, ih=0; let raf=false; let dragging=false; let last={x:0,y:0};

      function apply(){ img.style.transform=`translate(${tx}px,${ty}px) scale(${s})`; raf=false }
      function schedule(){ if(!raf){ raf=true; requestAnimationFrame(apply) } }
      function measure(){ vw=stage.clientWidth; vh=stage.clientHeight; }
      function fitContain(nudge=1.02){ measure(); const k=Math.min(vw/iw, vh/ih); s0=k; s=k*nudge; const cx=vw/2, cy=vh/2; const ix=iw/2, iy=ih/2; tx=cx - ix*s; ty=cy - iy*s; clamp(); apply(); }
      function clamp(){ const dw=iw*s, dh=ih*s; const pad=Math.max(vw,vh)*EDGE_PAD; if(dw<=vw){ const cx=(vw-dw)/2; tx=Math.max(cx-pad, Math.min(cx+pad, tx)); } else { tx=Math.max(vw-dw-pad, Math.min(pad, tx)); } if(dh<=vh){ const cy=(vh-dh)/2; ty=Math.max(cy-pad, Math.min(cy+pad, ty)); } else { ty=Math.max(vh-dh-pad, Math.min(pad, ty)); } }
      function clientToImage(x,y){ return { x:(x-tx)/s, y:(y-ty)/s }; }
      function zoomAt(newScale, cx, cy){ newScale=Math.max(sMin, Math.min(sMax, newScale)); const p=clientToImage(cx,cy); s=newScale; tx=cx - p.x*s; ty=cy - p.y*s; clamp(); schedule(); }

      function onWheel(e){ e.preventDefault(); const f=Math.pow(1.0012,-e.deltaY); zoomAt(s*f, e.clientX, e.clientY); }
      function onDown(e){ dragging=true; last={x:e.clientX,y:e.clientY}; }
      function onMove(e){ if(!dragging) return; const base=(e.pointerType==='touch')?TOUCH_BOOST:1; const dpr=Math.max(1,window.devicePixelRatio/1.3); const boost=base*dpr*Math.max(1,(s/s0)); tx+= (e.clientX-last.x)*boost; ty+= (e.clientY-last.y)*boost; last={x:e.clientX,y:e.clientY}; clamp(); schedule(); e.preventDefault(); }
      function onUp(){ dragging=false; }

      const active=new Map(); let pinch=null;
      function pDown(e){ stage.setPointerCapture && stage.setPointerCapture(e.pointerId); active.set(e.pointerId,{x:e.clientX,y:e.clientY}); if(active.size===2){ const a=[...active.values()]; const c={x:(a[0].x+a[1].x)/2,y:(a[0].y+a[1].y)/2}; pinch={c,dist:Math.hypot(a[0].x-a[1].x,a[0].y-a[1].y), s0:s}; } }
      function pMove(e){ if(!active.has(e.pointerId)) return; active.set(e.pointerId,{x:e.clientX,y:e.clientY}); if(active.size===1&&!pinch){ onMove(e); } if(active.size===2&&pinch){ const a=[...active.values()]; const c={x:(a[0].x+a[1].x)/2,y:(a[0].y+a[1].y)/2}; const d=Math.hypot(a[0].x-a[1].x,a[0].y-a[1].y); const f=d/(pinch.dist||1); zoomAt(pinch.s0*f, c.x, c.y); e.preventDefault(); } }
      function pUp(e){ active.delete(e.pointerId); if(active.size<2) pinch=null; dragging=false; }

      function bind(){ stage.addEventListener('wheel',onWheel,{passive:false}); stage.addEventListener('pointerdown',pDown,{passive:false}); stage.addEventListener('pointermove',pMove,{passive:false}); stage.addEventListener('pointerup',pUp,{passive:false}); stage.addEventListener('pointercancel',pUp,{passive:false}); stage.addEventListener('pointerleave',pUp,{passive:false}); document.getElementById('zoomIn').addEventListener('click',()=>{ const r=stage.getBoundingClientRect(); zoomAt(s*1.25, r.left+r.width/2, r.top+r.height/2); }); document.getElementById('zoomOut').addEventListener('click',()=>{ const r=stage.getBoundingClientRect(); zoomAt(s/1.25, r.left+r.width/2, r.top+r.height/2); }); document.getElementById('reset').addEventListener('click',()=>fitContain()); let t; window.addEventListener('resize',()=>{ clearTimeout(t); t=setTimeout(()=>fitContain(),80); }); }

      img.addEventListener('error',()=>{ console.error('Falha ao carregar a imagem:', IMG_PATH); });
      img.addEventListener('load',()=>{ iw=img.naturalWidth; ih=img.naturalHeight; sMin=Math.min(stage.clientWidth/iw, stage.clientHeight/ih)*0.5; bind(); fitContain(); });
      img.src = encodeURI(IMG_PATH);
    })();
  </script>
</body>
</html>


